$(function() {

  // for displaying the game
  var game = new Game("<%= j @game.pgn.html_safe %>", 'board');

  // button controls
  $('.controls .btn').click(function(e) {
    switch($(this).data('btn')) {
      case '<<':
        game.goto_start();
        break;
      case '<':
        game.take_back();
        break;
      case '>':
        game.play_move();
        break;
      case '>>':
        game.goto_end();
        break;
    }
  });

  // keyboard controls
  $(window).keydown(function(e) {
    switch (e.keyCode) {
      case 39: // right arrow
        game.play_move();
        break;
      case 37: // left arrow
        game.take_back();
        break;
      case 69: // 'e' for end
        game.goto_end();
        break;
      case 83: // 's' for start
        game.goto_start();
        break;
    }
  });

  // resize the board when the window changes
  $(window).resize(function() {
    game.resize();
  });

  // for toggling the PGN which is initally hidden
  $('#toggle_pgn').click(function(e) {
    e.preventDefault();
    $('pre.pgn').toggle();
  });
  $('pre.pgn').hide();
});
